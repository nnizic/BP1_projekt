| r. br. | Opis                                                    | VIEW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------ | ------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1      | Voditelj salona bez informacija o plaći, OIB-u i slično | ` CREATE VIEW pregled_voditelja_salona AS SELECT  o.ime,         o.prezime,         o.email,         s.id AS id_salona,         s.naziv AS naziv_salona,         s.adresa AS adresa_salona,         TIMESTAMPDIFF(YEAR, z.datum_rodenja, CURDATE()) AS godine FROM voditelj_salona vs JOIN zaposlenik z ON vs.id_zaposlenika = z.id JOIN osoba o ON z.id = o.id JOIN salon s ON vs.id_salona = s.id;`                                                                                                                                                                                                                                                                                                                                    |
| 2      | Pregled ukupnih servisnih troškova po modelu            | ` CREATE VIEW servisi_po_modelu AS SELECT m.naziv_modela AS model,        COUNT(s.id_servisa) AS broj_servisa,        SUM(s.ukupna_cijena) AS ukupni_trosak_servisa FROM servis s JOIN automobil a ON s.id_automobila = a.id JOIN model_automobila m ON a.id_modela = m.id GROUP BY m.naziv_modela;`                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 3      | Pregled dobavljača po tipu i narudžbi                   | ` CREATE VIEW dobavljaci_po_tipu AS SELECT d.tip_dobavljaca,        COUNT(DISTINCT d.id) AS broj_dobavljaca,        COUNT(n.id) AS broj_narudzbi FROM dobavljac d LEFT JOIN narudzba n ON d.id = n.id_dobavljaca GROUP BY d.tip_dobavljaca;`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 4      | Pregled narudžbi prema statusu                          | ` CREATE VIEW status_narudzbi AS SELECT status_narudzbe,        COUNT(*) AS broj_narudzbi,        SUM(ukupna_vrijednost) AS ukupna_vrijednost FROM narudzba GROUP BY status_narudzbe;`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 5      | Pregled hitnih narudžbi dobavljača                      | ` CREATE VIEW hitne_narudzbe_dobavljaca AS SELECT n.id AS id_narudzbe,        d.naziv AS dobavljac,        n.datum_narudzbe,        n.ocekivani_datum_isporuke,        n.stvarni_datum_isporuke,        n.status_narudzbe FROM narudzba n  JOIN dobavljac d ON n.id_dobavljaca = d.id WHERE n.tip_narudzbe = 'hitna';`                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 6      | Pregled zaposlenika i postavljenih ciljeva              | ` CREATE VIEW ciljevi_zaposlenika AS SELECT o.ime &#124;&#124;' '&#124;&#124; o.prezime as zaposlenik,        s.naziv as salon,        p.opis_cilja,        p.tip_cilja,        p.datum_početka,        p.datum_zavrsetka,        p.ciljna_vrijednost from prodajni_cilj p  join zaposlenik z on p.id_zaposlenika = z.id join osoba o on z.id = o.id join salon s on p.id_salona = s.id;`                                                                                                                                                                                                                                                                                                                                                |
| 7      | zbrajanje narudžbi po dobavljaču                        | ` create view ukupna_vrijednost_narudzbi as select d.naziv as dobavljac,        sum(n.ukupna_vrijednost) as ukupna_vrijednost,        count(n.id) as broj_narudzbi from narudzba n join dobavljac d on n.id_dobavljaca = d.id group by d.naziv;`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 8      | pregled servisnih stavki s troškovima                   | ` create view servisne_stavke as select s.id_servisa,        a.id as id_automobila,        m.naziv_modela as model,        s.tip_stavke,        s.opis_stavke,        s.kolicina,        s.jedinicna_cijena,        s.ukupna_cijena_stavke from servis s  join automobil a on s.id_automobila = a.id join model_automobila m on a.id_modela = m.id;`                                                                                                                                                                                                                                                                                                                                                                                     |
| 9      | detaljni prikaz testnih vožnji                          | ` create view testne_voznje_detaljno as  select ok.ime &#124;&#124; ' ' &#124;&#124; ok.prezime as kupac,        a.vin,        m.naziv_modela,        ma.naziv_marke as marka,        tv.datum_voznje,        tv.vrijeme_pocetka,        tv.vrijeme_zavrsetka,        tv.prijedena_kilometraza,        tv.napomena,        tv.povratna_informacija,        oz.ime &#124;&#124;' '&#124;&#124; oz.prezime as prodajni_savjetnik from testna_voznja tv join kupac k on tv.id_kupca = k.id join osoba ok on k.id = ok.id join automobil a on k.id = ok.id join model_automobila m on a.id_modela = m.id join marka_automobila ma on m.id_marke = ma.id join zaposlenik z on tv.id_prodajni_savjetnik = z.id join osoba oz on z.id = oz.id;` |
| 10     | detaljni prikaz rezervacija automobila                  | ` create view rezervacije_automobila as select ok.ime $#124;$#124;' '$#124;$#124; ok.prezime as kupac,        a.vin,        m.naziv_modela,        ma.naziv_marke as marka,        r.datum_rezervacije,        r.datum_isteka_rezervacije,        r.iznos_kapare,        r.status_rezervacije,        oz.ime &#124;&#124;' '&#124;&#124; oz.prezime as prodajni_savjetnik from rezervacija r  join kupac k on r.id_kupca = k.id join osoba ok on k.id = ok.id join automobil a on r.id_automobila = a.id join model_automobila m on a.id_modela = m.id join marka_automobila ma on m.id_marke = ma.id join zaposlenik z on r.id_prodajni_savjetnik = z.id join osoba oz on z.id = oz.id;`                                                |

| r. br. | opis upita                                                                    | sql upit vezan uz VIEW                                                                        |
| ------ | ----------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- |
| 1.1    | Prikaz voditelja starijih od 35 godina                                        | `sql SELECT * FROM pregled_voditelja_salona WHERE godine > 35; `                              |
| 1.2    | Prikaz troškova servisa automobila koji su bili na servisu više puta          | `sql SELECT * FROM servisi_po_modelu WHERE broj_servisa > 1; `                                |
| 1.3    | Prikaz tipa dobavljača gdje ima više dobavljača za isti tip                   | `sql SELECT * FROM dobavljaci_po_tipu WHERE broj_dobavljaca &gt;= 2; `                        |
| 1.4    | Prikaz narudžbi po statusu gdje je više od 2 narudžbe                         | `sql SELECT * FROM status_narudzbi WHERE broj_narudzbi &gt; 2; `                              |
| 1.5    | Prikaz hitnih narudžbi sortiranih prema datumu                                | `sql SELECT * FROM hitne_narudzbe_dobavljaca ORDER BY datum_narudzbe DESC; `                  |
| 1.6    | Prikaz mjesečnih ciljeva salona                                               | `sql SELECT * FROM ciljevi_zaposlenika WHERE tip_cilja = 'mjesecni'; `                        |
| 1.7    | Prikaz ukupne vrijednosti narudžbe dobavljača, ako je vrijednost viša od 1000 | `sql SELECT * FROM ukupna_vrijednost_narudzbi WHERE ukupna_vrijednost &gt; 1000; `            |
| 1.8    | Prikaz servisnih stavki ukoliko im je ukupna cijena viša od 100               | `sql SELECT * FROM servisne_stavke WHERE ukupna_cijena_stavke &gt; 100; `                     |
| 1.9    | Prikaz testnih vožnji dužih od 10 kilometara                                  | `sql SELECT * FROM testne_voznje_detaljno WHERE prijedena_kilometraza &gt; 10; `              |
| 1.10   | Prikaz rezervacija pretvorenih u ugovor                                       | `sql SELECT * FROM rezervacije_automobila WHERE status_rezervacije = 'pretvorena u ugovor'; ` |

| r. br. | Opis upita                                                                            | SQL upit                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ------ | ------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 2      | Prosječna plaća po poziciji zaposlenika, sortirano silazno                            | ` ` `  SELECT pozicija, AVG(placa) AS prosjecna_placa FROM zaposlenik GROUP BY pozicija ORDER BY prosjecna_placa DESC;` ` `                                                                                                                                                                                                                                                                                                                |
| 3      | Prikaz smjena koje počinju prije 8 i završavaju poslije 16 sati s imenima zaposlenika | ` ` `  SELECT s.naziv_smjene, o.ime, o.prezime FROM smjena s JOIN raspored_rada r ON s.id = r.id_smjene JOIN zaposlenik z ON r.id_zaposlenika = z.id JOIN osoba o ON z.id = o.id WHERE s.vrijeme_pocetka < '08:00:00' AND s.vrijeme_zavrsetka > '16:00:00';` ` `                                                                                                                                                                           |
| 4      | Ukupan broj prodanih automobila po zaposleniku u zadnjih 6 mjeseci                    | ` ` `  SELECT o.ime, o.prezime, COUNT(p.id) AS broj_prodaja FROM zaposlenik z JOIN osoba o ON z.id = o.id JOIN ugovor p ON z.id = p.id_prodajni_savjetnik WHERE p.datum_sklapanja >= DATE_SUB(CURDATE(), INTERVAL 6 MONTH) GROUP BY o.id, o.ime, o.prezime ORDER BY broj_prodaja DESC;` ` `                                                                                                                                                |
| 5      | Kupci koji su kupili više automobila u istom mjesecu                                  | ` ` `  SELECT o.ime, o.prezime FROM kupac k JOIN osoba o ON k.id = o.id JOIN ugovor u ON k.id = u.id_kupca GROUP BY k.id, YEAR(u.datum_sklapanja), MONTH(u.datum_sklapanja) HAVING COUNT(u.id) > 1;` ` `                                                                                                                                                                                                                                   |
| 6      | Modeli automobila bez ijednog automobila                                              | ` ` `  SELECT ma.naziv_modela FROM model_automobila ma LEFT JOIN automobil a ON ma.id = a.id_modela WHERE a.id IS NULL;` ` `                                                                                                                                                                                                                                                                                                               |
| 7      | Ukupan broj radnih sati u tjednu po zaposleniku                                       | ` ` `  SELECT o.ime, o.prezime, SUM(CASE  WHEN s.vrijeme_zavrsetka > s.vrijeme_pocetka THEN TIMESTAMPDIFF(HOUR, s.vrijeme_pocetka, s.vrijeme_zavrsetka)  ELSE TIMESTAMPDIFF(HOUR, s.vrijeme_pocetka, ADDTIME(s.vrijeme_zavrsetka, '24:00:00')) END) AS total_hours FROM zaposlenik z JOIN osoba o ON z.id = o.id JOIN raspored_rada r ON z.id = r.id_zaposlenika JOIN smjena s ON r.id_smjene = s.id GROUP BY z.id, o.ime, o.prezime;` ` ` |
| 8      | Saloni gdje bar jedan zaposlenik nije imao prodaju u zadnjih 30 dana                  | ` ` `  SELECT DISTINCT s.naziv FROM salon s LEFT JOIN zaposlenik z ON s.id = z.id_salona LEFT JOIN ugovor u ON z.id = u.id_prodajni_savjetnik AND u.datum_sklapanja >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) WHERE u.id IS NULL;` ` `                                                                                                                                                                                                       |
| 9      | Saloni u kojima niti jedan zaposlenik nije imao prodaju u zadnjih 30 dana             | ` ` `  SELECT s.naziv FROM salon s WHERE NOT EXISTS (  SELECT 1 FROM zaposlenik z JOIN ugovor u ON z.id = u.id_prodajni_savjetnik  WHERE z.id_salona = s.id  AND u.datum_sklapanja >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) );` ` `                                                                                                                                                                                                         |
| 10     | Osnovni podaci za rabljeno vozilo                                                     | ` ` `  SELECT a.VIN, a.maloprodajna_cijena, ra.broj_prethodnih_vlasnika, ra.stanje, s.naziv AS naziv_salona FROM automobil a JOIN rabljeni_automobil ra ON a.id = ra.id JOIN salon s ON a.id_salona = s.id WHERE a.tip_automobila = 'rabljeni';` ` `                                                                                                                                                                                       |
| 11     | Tri najprodavanija modela automobila u posljednjih godinu dana                        | ` ` `  SELECT m.naziv_modela, COUNT(u.id) AS broj_prodaja FROM ugovor u JOIN automobil a ON u.id_automobila = a.id JOIN model_automobila m ON a.id_modela = m.id WHERE u.datum_sklapanja >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY m.naziv_modela ORDER BY broj_prodaja DESC LIMIT 3;` ` `                                                                                                                                          |
| 12     | Kupci koji su kupili automobil po cijeni većoj od prosječne za taj model              | ` ` `  SELECT o.ime, o.prezime FROM kupac k JOIN osoba o ON k.id = o.id JOIN ugovor u ON k.id = u.id_kupca JOIN automobil a ON u.id_automobila = a.id JOIN model_automobila m ON a.id_modela = m.id WHERE a.maloprodajna_cijena > (  SELECT AVG(a2.maloprodajna_cijena)  FROM automobil a2  WHERE a2.id_modela = a.id_modela );` ` `                                                                                                       |
| 13     | Zaposlenici koji su radili više od jedne smjene u danu                                | ` ` `  SELECT o.ime, o.prezime, COUNT(r.id) AS broj_smjena_u_danu FROM zaposlenik z JOIN osoba o ON z.id = o.id JOIN raspored_rada r ON z.id = r.id_zaposlenika GROUP BY z.id, r.datum HAVING broj_smjena_u_danu > 1;` ` `                                                                                                                                                                                                                 |
| 14     | Zaposlenici i prosječna plaća po voditelju salona (bez voditelja)                     | ` ` `  SELECT o.ime, o.prezime, s.naziv AS naziv_salona, COUNT(z.id) AS broj_zaposlenika, AVG(z.placa) AS prosjecna_placa FROM voditelj_salona vs JOIN zaposlenik v ON vs.id_zaposlenika = v.id JOIN osoba o ON v.id = o.id JOIN salon s ON vs.id_salona = s.id JOIN zaposlenik z ON z.id_salona = s.id AND z.id != v.id GROUP BY v.id, o.ime, o.prezime, s.naziv;` ` `                                                                    |
| 15     | Ukupni prihod po mjesecima u zadnje dvije godine                                      | ` ` `  SELECT YEAR(u.datum_sklapanja) AS godina, MONTH(u.datum_sklapanja) AS mjesec, SUM(u.ukupna_cijena) AS ukupni_prihod FROM ugovor u WHERE u.datum_sklapanja >= DATE_SUB(CURDATE(), INTERVAL 2 YEAR) GROUP BY godina, mjesec ORDER BY godina, mjesec;` ` `                                                                                                                                                                             |
| 16     | Zaposlenici koji su postigli prodajne ciljeve u određenom mjesecu                     | `  SELECT o.ime, o.prezime, c.mjesec, c.godina FROM ostvarenje_cilja c JOIN zaposlenik z ON c.id_zaposlenika = z.id JOIN osoba o ON z.id = o.id WHERE c.ostvareni_iznos >= c.postavljeni_cilj;`                                                                                                                                                                                                                                            |
| 17     | Broj servisa po automobilu u posljednjih godinu dana                                  | `  SELECT a.VIN, COUNT(s.id) AS broj_servisa FROM automobil a JOIN servis s ON a.id = s.id_automobila WHERE s.datum_servisa >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY a.VIN;`                                                                                                                                                                                                                                                       |
| 18     | Dobavljači koji opskrbljuju više od jednog brenda                                     | `  SELECT d.naziv_dobavljaca FROM dobavljac d JOIN dobavljac_marka dm ON d.id = dm.id_dobavljaca GROUP BY d.id, d.naziv_dobavljaca HAVING COUNT(DISTINCT dm.id_marke) > 1;`                                                                                                                                                                                                                                                                |
| 19     | Automobili koji nisu bili na servisu više od godinu dana                              | `  SELECT a.VIN FROM automobil a LEFT JOIN servis s ON a.id = s.id_automobila GROUP BY a.id, a.VIN HAVING MAX(s.datum_servisa) < DATE_SUB(CURDATE(), INTERVAL 1 YEAR) OR MAX(s.datum_servisa) IS NULL;`                                                                                                                                                                                                                                    |
| 20     | Paketi opreme koji sadrže više od tri različite opreme                                | `  SELECT p.naziv_paketa FROM paket_opreme p JOIN oprema_u_paketu oup ON p.id = oup.id_paketa GROUP BY p.id, p.naziv_paketa HAVING COUNT(DISTINCT oup.id_opreme) > 3;`                                                                                                                                                                                                                                                                     |
